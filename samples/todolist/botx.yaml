package: main

i18n:
  default: en
  content:
    nav:
      back:
        zh-hans: "â¬…ï¸ è¿”å›"
        en: "â¬…ï¸ Back"
        es: "â¬…ï¸ Atras"
      home:
        zh-hans: "ğŸ  ä¸»é¡µ"
        en: "ğŸ  Home"
        es: "ğŸ  Inicio"
      i18n:
        zh-hans: "ğŸŒ è¯­è¨€"
        en: "ğŸŒ Language"
        es: "ğŸŒ Idioma"
    todo:
      empty:
        zh-hans: "æš‚æ— å¾…åŠäº‹é¡¹ï¼Œæ·»åŠ ä¸€ä¸ªå§ã€‚âœ¨"
        en: "No todos yet. Add one below. âœ¨"
        es: "No hay tareas aun. Agrega una abajo. âœ¨"
      select:
        zh-hans: "é€‰æ‹©ä¸€ä¸ªå¾…åŠæŸ¥çœ‹è¯¦æƒ…ã€‚ğŸ‘‡"
        en: "Select a todo to view details. ğŸ‘‡"
        es: "Selecciona una tarea para ver detalles. ğŸ‘‡"
      prev:
        zh-hans: "â¬…ï¸ ä¸Šä¸€é¡µ"
        en: "â¬…ï¸ Prev"
        es: "â¬…ï¸ Anterior"
      next:
        zh-hans: "ä¸‹ä¸€é¡µ â¡ï¸"
        en: "Next â¡ï¸"
        es: "Siguiente â¡ï¸"
      add_button:
        zh-hans: "â• æ·»åŠ å¾…åŠ"
        en: "â• Add Todo"
        es: "â• Agregar tarea"
      add:
        title_label:
          zh-hans: "æ ‡é¢˜"
          en: "Title"
          es: "Titulo"
        title_tip:
          zh-hans: "è¯·è¾“å…¥ç®€çŸ­çš„å¾…åŠæ ‡é¢˜ã€‚"
          en: "Enter a short todo title."
          es: "Ingresa un titulo corto."
        success:
          zh-hans: "å¾…åŠå·²æ·»åŠ ã€‚ä½¿ç”¨æŒ‰é’®è¿”å›ã€‚âœ…"
          en: "Todo added. Use the buttons to go back. âœ…"
          es: "Tarea agregada. Usa los botones para volver. âœ…"
        fail:
          zh-hans: "æ·»åŠ å¾…åŠå¤±è´¥: %s âŒ"
          en: "Failed to add todo: %s âŒ"
          es: "No se pudo agregar la tarea: %s âŒ"
      detail:
        title_prefix:
          zh-hans: "æ ‡é¢˜: "
          en: "Title: "
          es: "Titulo: "
        status_prefix:
          zh-hans: "çŠ¶æ€: "
          en: "Status: "
          es: "Estado: "
        status_done:
          zh-hans: "å·²å®Œæˆ âœ…"
          en: "done âœ…"
          es: "completada âœ…"
        status_open:
          zh-hans: "æœªå®Œæˆ â³"
          en: "open â³"
          es: "pendiente â³"
        toggle_button:
          zh-hans: "âœ… åˆ‡æ¢å®ŒæˆçŠ¶æ€"
          en: "âœ… Toggle Done"
          es: "âœ… Alternar estado"
        delete_button:
          zh-hans: "ğŸ—‘ï¸ åˆ é™¤"
          en: "ğŸ—‘ï¸ Delete"
          es: "ğŸ—‘ï¸ Eliminar"
        back_list:
          zh-hans: "ğŸ“‹ è¿”å›åˆ—è¡¨"
          en: "ğŸ“‹ Back to List"
          es: "ğŸ“‹ Volver a la lista"
      toggle:
        done:
          zh-hans: "å¾…åŠæ ‡è®°ä¸ºå·²å®Œæˆã€‚âœ…"
          en: "Todo marked done. âœ…"
          es: "Tarea marcada como completada. âœ…"
        open:
          zh-hans: "å¾…åŠæ ‡è®°ä¸ºæœªå®Œæˆã€‚â³"
          en: "Todo marked open. â³"
          es: "Tarea marcada como pendiente. â³"
        fail:
          zh-hans: "æ›´æ–°å¾…åŠå¤±è´¥: %s âŒ"
          en: "Failed to update todo: %s âŒ"
          es: "No se pudo actualizar la tarea: %s âŒ"
        back_todo:
          zh-hans: "ğŸ“ è¿”å›å¾…åŠ"
          en: "ğŸ“ Back to Todo"
          es: "ğŸ“ Volver a la tarea"
      delete:
        success:
          zh-hans: "å¾…åŠå·²åˆ é™¤ã€‚ğŸ§¹"
          en: "Todo deleted. ğŸ§¹"
          es: "Tarea eliminada. ğŸ§¹"
        fail:
          zh-hans: "åˆ é™¤å¾…åŠå¤±è´¥: %s âŒ"
          en: "Failed to delete todo: %s âŒ"
          es: "No se pudo eliminar la tarea: %s âŒ"
    i18n:
      title:
        zh-hans: "è¯·é€‰æ‹©è¯­è¨€"
        en: "Choose a language"
        es: "Elige un idioma"
      zh:
        zh-hans: "ä¸­æ–‡"
        en: "ä¸­æ–‡"
        es: "ä¸­æ–‡"
      en:
        zh-hans: "English"
        en: "English"
        es: "English"
      es:
        zh-hans: "espanol"
        en: "espanol"
        es: "espanol"

navbar:
  rows:
    - columns:
        - label: ${content.nav.back}
          onClick: route:back
        - label: ${content.nav.home}
          onClick: route:/

handlers:
  - match: /start
    matchType: exact
    type: command
    action: router.push(ctx, "/")

pages:
  /:
    parameters:
      - name: column
        in: query
        schema:
          type: integer
          default: 2
      - name: row
        in: query
        schema:
          type: integer
          default: 5
      - name: page
        in: query
        schema:
          type: integer
          default: 0
    state:
      type: object
      required: []
      properties:
        items:
          type: array
          items:
            schema: "#components/schemas/Todo"
        total:
          type: integer
    view:
      parseMode: HTML
      message: |
        ${cond(len(state) == 0, content.todo.empty, "")}
        ${forEach(
            state,
            func (index int, item Todo) string {
              return fmt.Sprintf(
                "%d. %s<code>%s</code>\n",
                index + 1,
                cond(item.done, "[x] ", "[ ] "),
                item.title,
              )
            }),
        }
        ${cond(len(state) == 0, "", content.todo.select)}
      buttons:
        grids:
          - pagination:
              columns: parameters.column
              rows: parameters.row
              total: state.total
              page: parameters.page
              items: state.items
              item:
                label: ${cond(item.done, "[x] " + item.title, "[ ] " + item.title)}
                onClick: route:/todo/${item.ID}
              prevLabel: ${content.todo.prev}
              nextLabel: ${content.todo.next}
          - rows:
              - columns:
                  - label: ${content.todo.add_button}
                    onClick: route:/todo/add
                  - label: ${content.nav.i18n}
                    onClick: route:/i18n

  /i18n:
    view:
      message: ${content.i18n.title}
      buttons:
        grid:
          rows:
            - columns:
                - label: ${content.i18n.zh}
                  onClick: lang:zh-hans
                - label: ${content.i18n.en}
                  onClick: lang:en
                - label: ${content.i18n.es}
                  onClick: lang:es

  /todo/add:
    form:
      required: [title]
      fields:
        title:
          label: ${content.todo.add.title_label}
          input:
            schema:
              type: string
            tip: ${content.todo.add.title_tip}
    state:
      type: object
      required: [success, error]
      properties:
        success:
          type: boolean
        error:
          type: string
    view:
      message: |
        ${cond(
            state.success,
            content.todo.add.success,
            fmt.Sprintf(content.todo.add.fail, state.error),
        )}

  /todo/{ID}:
    parameters:
      path:
        - name: ID
          in: path
          schema:
            type: integer
            format: int64
          required: true
    state:
      schema: "#components/schemas/Todo"
    view:
      parseMode: HTML
      message: |
        ${content.todo.detail.title_prefix}<code>${state.title}</code>
        ${content.todo.detail.status_prefix}${cond(state.done, content.todo.detail.status_done, content.todo.detail.status_open)}
      buttons:
        grid:
          rows:
            - columns:
                - label: ${content.todo.detail.toggle_button}
                  onClick: route:/todo/${parameters.ID}/toggle
                - label: ${content.todo.detail.delete_button}
                  onClick: route:/todo/${parameters.ID}/delete
                - label: ${content.todo.detail.back_list}
                  onClick: route:/

  /todo/{ID}/toggle:
    parameters:
      path:
        - name: ID
          in: path
          schema:
            type: integer
            format: int64
          required: true
    state:
      type: object
      required: [success, error, done]
      properties:
        success:
          type: boolean
        error:
          type: string
        done:
          type: boolean
    view:
      message: |
        ${cond(
            state.success,
            cond(state.done, content.todo.toggle.done, content.todo.toggle.open),
            fmt.Sprintf(content.todo.toggle.fail, state.error),
        )}
      buttons:
        grid:
          rows:
            - columns:
                - label: ${content.todo.toggle.back_todo}
                  onClick: route:/todo/${parameters.ID}
                - label: ${content.todo.detail.back_list}
                  onClick: route:/

  /todo/{ID}/delete:
    parameters:
      path:
        - name: ID
          in: path
          schema:
            type: integer
            format: int64
          required: true
    state:
      type: object
      required: [success, error]
      properties:
        success:
          type: boolean
        error:
          type: string
    view:
      message: |
        ${cond(
            state.success,
            content.todo.delete.success,
            fmt.Sprintf(content.todo.delete.fail, state.error),
        )}
      buttons:
        grid:
          rows:
            - columns:
                - label: ${content.todo.detail.back_list}
                  onClick: route:/

components:
  schemas:
    Todo:
      type: object
      required: [ID, title, done]
      properties:
        ID:
          type: integer
          format: int64
        title:
          type: string
        done:
          type: boolean
